<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Kristaps Grinbergs"/><link rel="canonical" href="https://kristaps.me/blog/nested-mappings-solidity"/><meta name="twitter:url" content="https://kristaps.me/blog/nested-mappings-solidity"/><meta name="og:url" content="https://kristaps.me/blog/nested-mappings-solidity"/><title>Exploring Nested Mappings in Solidity | Kristaps Grinbergs</title><meta name="twitter:title" content="Exploring Nested Mappings in Solidity | Kristaps Grinbergs"/><meta name="og:title" content="Exploring Nested Mappings in Solidity | Kristaps Grinbergs"/><meta name="description" content="Nested mappings in Solidity offer developers powerful tools to efficiently organize and manipulate complex data structures. This blog post explores how to use nested mappings and their practical applications and provides transformative examples in smart contract development."/><meta name="twitter:description" content="Nested mappings in Solidity offer developers powerful tools to efficiently organize and manipulate complex data structures. This blog post explores how to use nested mappings and their practical applications and provides transformative examples in smart contract development."/><meta name="og:description" content="Nested mappings in Solidity offer developers powerful tools to efficiently organize and manipulate complex data structures. This blog post explores how to use nested mappings and their practical applications and provides transformative examples in smart contract development."/><meta name="og:site_name" content="Kristaps Grinbergs - Blockchain, mobile and fullstack developer. Startup founder. Conference speaker. Mentor. Passionate about building products, sustainability and Web 3.0"/><meta name="og:title" content="Kristaps Grinbergs - Blockchain, mobile and fullstack developer. Startup founder. Conference speaker. Mentor. Passionate about building products, sustainability and Web 3.0"/><meta name="og:description" content="Kristaps Grinbergs - Blockchain, mobile and fullstack developer. Startup founder. Conference speaker. Mentor. Passionate about building products, sustainability and Web 3.0"/><meta name="og:image" content="https://kristaps.me/og-image.png"/><meta name="og:image:secure_url" content="https://kristaps.me/og-image.png"/><meta name="og:type" content="website"/><meta name="og:url" content="https://kristaps.me"/><meta name="og:image:secure_url" content="https://kristaps.me/og-image.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:site" content="@fassko"/><meta name="twitter:title" content="Kristaps Grinbergs"/><meta name="twitter:description" content="Kristaps Grinbergs - Blockchain, mobile and fullstack developer. Startup founder. Conference speaker. Mentor. Passionate about building products, sustainability and Web 3.0"/><meta name="twitter:image" content="fb-og.png"/><link href="https://fonts.gstatic.com" rel="preconnect"/><link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&display=swap" rel="stylesheet"/><link rel="apple-touch-icon-precomposed" sizes="120x120" href="apple-touch-icon-120x120.png"/><script async src="https://www.googletagmanager.com/gtag/js?id=G-HBCE3H3QVL"></script><script src="/scripts/ga.js"></script><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Kristaps Grinbergs"/></head><body><header class="header"><div class="header-wrapper"><div class="main-title"><a href="/">Kristaps Grinbergs</a></div><nav class="nav-container"><nav><ul class="nav"><li class="nav-item"><a href="/">home</a></li><li class="nav-item"><a href="/blog">blog</a></li><li class="nav-item"><a href="/talks">talks</a></li><li class="nav-item"><a href="/about">about</a></li></ul></nav></nav></div></header><div class="wrapper"><section class="blog-list"><div class="blog-item"><h1><a class="blog-title" href="/blog/nested-mappings-solidity">Exploring Nested Mappings in Solidity</a></h1><div class="blog-date"><ul class="blog-tags"><li><a href="/tags/ethereum">ethereum</a></li><li><a href="/tags/solidity">solidity</a></li></ul>Feb 28, 2024</div><div class="blog-content"><p>Nested mappings in Solidity offer developers powerful tools to efficiently organize and manipulate complex data structures. This blog post explores how to use nested mappings and their practical applications and provides transformative examples in smart contract development.</p><h2>Nested Mapping in Solidity</h2><p>In Solidity, nested mapping involves using one mapping as the value type within another mapping. This technique enables developers to create multidimensional data structures within Ethereum smart contracts. Nested mappings facilitate hierarchical relationships between data elements.</p><p>In this post, we'll delve into an illustrative example showcasing how to organize employee records based on their respective departments efficiently.</p><p>First, we need to define a nested mapping. We can achieve that like a <a href="/blog/solidity-mapping/">regular mapping</a>, but we use another mapping instead of type.</p><pre><code><span class="call">mapping</span>(string =&gt; <span class="call">mapping</span>(address =&gt; <span class="type">Employee</span>)) <span class="keyword">private</span> employees;
</code></pre><p>In this example, we will use a <a href="/blog/solidity-structs/">Solidity struct type</a> that holds employee data like name and salary.</p><pre><code><span class="keyword">struct</span> Employee {
  string name;
  uint256 salary;
}
</code></pre><h2>Storing Values in a Nested Mapping</h2><p>When storing a value in a Solidity nested mapping, assigning the value based on the corresponding key pairs is essential. In our example, we use <code>department</code> and <code>address</code> keys. These keys are pivotal in structuring our example's nested mapping data.</p><pre><code>employees[department][_address] = <span class="type">Employee</span>(name, salary);
</code></pre><p>From the code provided above, it's evident that each employee record is stored within a specific department and is uniquely identified by the employee's blockchain address. This organizational structure allows efficient retrieval and management of employee data within the nested mapping, ensuring clarity and accessibility across departments.</p><h2>Retrieving Values from a Nested Mapping</h2><p>To retrieve a value from a nested mapping, it's essential to possess the corresponding keys for both the <code>department</code> and the employee's <code>address</code>. The retrieved value could either be the employee record or the default values of the <code>Employee</code> type. For instance, for the <code>uint256</code> type, the default value is zero (<code>0</code>). This mechanism enables us to ascertain the existence of the value within the mapping structure.</p><pre><code><span class="type">Employee</span> memory employee = employees[department][_address];
</code></pre><p>We can use the <code>require</code> statement to check if the value exists and show an error if it does not.</p><pre><code><span class="call">require</span>(employee.<span class="property">salary</span> != <span class="number">0</span>, <span class="string">"Employee does not exist"</span>);
</code></pre><h2>Integrating the Code</h2><p>Now, let's put all the code together. This code shows how we can save and retrieve a value in Solidity nested mapping.</p><pre><code>contract <span class="type">NestedMapping</span> {
  <span class="keyword">struct</span> Employee {
    string name;
    uint256 salary;
  }

  <span class="call">mapping</span>(string =&gt; <span class="call">mapping</span>(address =&gt; <span class="type">Employee</span>)) <span class="keyword">private</span> employees;

  function <span class="call">getEmployee</span>(string memory department,
                      address _address) external view returns (<span class="type">Employee</span> memory) {
    <span class="type">Employee</span> memory employee = employees[department][_address];
    <span class="call">require</span>(employee.<span class="property">salary</span> != <span class="number">0</span>, <span class="string">"Employee does not exist"</span>);
    <span class="keyword">return</span> employee;
  }

  function <span class="call">addEmployee</span>(string memory department,
                      address _address,
                      string memory name,
                      uint256 salary)
  <span class="call">external</span> {
    <span class="call">require</span>(_address != <span class="call">address</span>(<span class="number">0</span>), <span class="string">"Invalid address"</span>);
    <span class="call">require</span>(<span class="call">bytes</span>(name).<span class="property">length</span> &gt; <span class="number">0</span>, <span class="string">"Name cannot be empty"</span>);
    <span class="call">require</span>(employees[department][_address].salary == <span class="number">0</span>, <span class="string">"Employee already exists"</span>);

    employees[department][_address] = <span class="type">Employee</span>(name, salary);
  }
}
</code></pre><h2>TL;DR</h2><p>Solidity nested mappings are versatile data structures that allow developers to organize and manage complex data within Ethereum smart contracts. Nested mappings facilitate efficient data retrieval and manipulation by associating multiple keys with corresponding values. They enable hierarchical data organization, empowering developers to create dynamic and structured storage solutions tailored to decentralized application (dApp) requirements.</p><h2>Links</h2><ul><li><a href="https://gist.github.com/fassko/5b7e40bb62a1605163a6bf3fd999fbeb">Demo code</a></li></ul><ul><li><a href="https://docs.soliditylang.org/en/v0.8.13/types.html">Official documentation</a></li><li><a href="https://solidity-by-example.org/mapping/">Solidity by Example - Mapping</a></li></ul></div></div></section></div><footer class="footer"><p>Copyright © Kristaps Grinbergs. 2025.</p><p><a href="https://twitter.com/fassko" target="_blank">Twitter</a>•<a href="/feed.rss">RSS</a>•<a href="/about">Contact</a></p></footer></body></html>